<html>
<head>
<script>
  function get_favorite_style(){
    return localStorage["favorite_style"] || "native";
  }

  function is_defered_page(url){
    return /[\w\d-]+\.ya\.ru(?!\/(post|repl))/.test(url);
  }

  function is_disabled_page(url){
    return false;
  }

  chrome.extension.onRequest.addListener(
  function(request, sender, sendResponse) {
    switch(request.ask){
        case "favorite_style": sendResponse({favorite_style: get_favorite_style()});

        case "page_settings": sendResponse({no_highlight: is_disabled_page(sender.tab.url), defered_highlight: is_defered_page(sender.tab.url)});

        default: sendResponse({});
    }
  });
</script>
</head>
</html>
